/*
#
# Generated by Chef for <%= node['fqdn'] %>
# local changes will be overwritten
#
*/

import org.graylog2.plugin.Message


rule "Drop monit postfix checks to localhost"
    when
        //(?s) is importent, syslog inserts strange chars into the log message
        m : Message(getField("facility") == "mail" && message matches "(?s).*connect.*from.*localhost.*")
    then
        m.setFilterOut(true);
end